# 乳児生活記録システム 要件定義書 v2.0

## ドキュメント情報
- **作成日**: 2026-01-17
- **バージョン**: 2.0（全面見直し版）
- **ステータス**: レビュー待ち
- **前バージョンからの主な変更**:
  - 複数園児一括登録から個別園児登録方式へ変更
  - ミルク記録の詳細化（mL単位での記録）
  - 午睡チェック項目の詳細化（SIDS対策準拠）
  - 排泄記録の詳細化（おしっこ・うんち同時記録対応）

---

## 目次
1. [概要](#1-概要)
2. [保育士ヒアリング結果](#2-保育士ヒアリング結果)
3. [競合他社調査結果](#3-競合他社調査結果)
4. [新仕様の全体設計](#4-新仕様の全体設計)
5. [機能要件詳細](#5-機能要件詳細)
6. [データモデル](#6-データモデル)
7. [UI/UX設計](#7-uiux設計)
8. [実装優先順位](#8-実装優先順位)

---

## 1. 概要

### 1.1 目的
乳児（0歳児）から幼児（3歳以上）までの保育園児の日々の生活記録を、年齢や発達段階に応じて柔軟に記録できるシステムを提供する。

### 1.2 適用範囲
- **対象年齢**: 0歳児～5歳児（主に0～2歳児の乳児記録に重点）
- **対象ユーザー**: 保育士（スタッフ）
- **対象デバイス**: タブレット、PC

### 1.3 背景
- **旧仕様の課題**: 複数園児の一括登録方式では、個別の詳細な記録（ミルクmL、午睡チェック頻度、排泄詳細）に対応できない
- **現場ニーズ**: 年齢によって記録項目が異なり、特に0歳児は5分ごとの午睡チェック、ミルクmL記録など詳細な記録が必要
- **業界標準**: コドモン、ルクミーなど主要ICTシステムは個別園児の時系列記録方式を採用

---

## 2. 保育士ヒアリング結果

### 2.1 食事（ミルク・離乳食）に関する要件

#### 2.1.1 0歳児（ミルクのみ）
- **記録内容**:
  - ミルクを飲んだ時刻
  - ミルクの量（mL単位、例: 100mL、150mL）
- **記録頻度**: 1日3～8回程度（個人差大）
- **記録タイミング**: ミルクを飲ませた直後

#### 2.1.2 1歳児（ミルク + 離乳食）
- **ミルク記録**:
  - 時刻 + 量（mL単位）
- **離乳食記録**:
  - 時刻 + 摂取量（あいまいな5段階評価）
    - 「完食」
    - 「ほぼ完食」
    - 「半分」
    - 「少量」
    - 「食べず」
- **記録頻度**: ミルク1日2～5回、離乳食1日2～3回

#### 2.1.3 2歳児以上（おやつ・昼食）
- **記録内容**:
  - 午前おやつ、昼食、午後おやつ
  - 摂取量（5段階評価: 完食、ほぼ完食、半分、少量、食べず）
- **記録頻度**: 1日3回（午前おやつ、昼食、午後おやつ）

### 2.2 午睡（お昼寝）に関する要件

#### 2.2.1 SIDS対策チェック項目
- **チェック時刻**: 5分ごと（0歳児）、10分ごと（1～2歳児）、15分ごと（3歳以上）
- **チェック項目**:
  1. **呼吸確認**: 胸や腹部の上下運動を目視確認
  2. **頭の向き**: 左向き、右向き、仰向け
  3. **体温チェック（触感）**: ほっぺや額を触って体温が正常か確認
     - 「正常」: 通常の体温
     - 「やや温かい」: 微熱の可能性
     - 「熱あり」: 明らかな発熱（緊急対応が必要）
     - 「冷たい」: 低体温や末梢循環不良の可能性
  4. **顔色**:
     - 「正常」: 通常の顔色
     - 「蒼白」: 血行不良や貧血の可能性
     - 「紫色（チアノーゼ）」: 酸素不足のサイン（緊急対応が必要）
     - 「紅潮（赤色）」: 発熱時の典型的な症状
  5. **体勢**: 「仰向け」「横向き」「うつ伏せ」（うつ伏せは即座に仰向けに戻す）

**医療的根拠**:
- 厚生労働省のSIDS予防ガイドラインでは、午睡中の観察項目として「呼吸状態」「皮膚の色（チアノーゼの有無）」「体温」「体勢」を重要視
- 41.5℃以上の発熱やチアノーゼは緊急を要する状態
- 発熱時は顔色が紅潮（赤く）なることが多く、体温チェックと併せて総合的に判断することが重要

#### 2.2.2 午睡時間の記録
- **開始時刻**: 園児が寝始めた時刻
- **終了時刻**: 園児が起きた時刻
- **チェック記録**: 午睡中のチェック履歴（時刻、呼吸、頭の向き、体温、顔色、体勢）

### 2.3 排泄（おむつ交換）に関する要件

#### 2.3.1 おしっこ（尿）
- **記録内容**:
  - 交換時刻
  - 量（「少量」「普通」「多量」）
- **記録頻度**: 1日5～10回程度

#### 2.3.2 うんち（便）
- **記録内容**:
  - 交換時刻
  - 量（「少量」「普通」「多量」）
  - 種類（「正常」「軟便」「下痢」「硬い」「血便」）
- **記録頻度**: 1日1～5回程度

#### 2.3.3 おしっこ + うんち（同時記録）
- **要件**: 同じおむつ交換でおしっことうんちの両方を確認した場合、両方を同時に記録できる必要がある
- **実装**: 1つの記録エントリに「おしっこ」と「うんち」の両方のデータを含められるようにする

### 2.4 その他の記録項目

#### 2.4.1 体温測定
- **記録内容**:
  - 測定時刻
  - 体温（℃単位、例: 36.5℃、37.2℃）
- **記録頻度**: 登園時、発熱時、午睡後など

#### 2.4.2 機嫌・様子
- **記録内容**:
  - 時刻
  - 機嫌（「良い」「普通」「不機嫌」「泣いている」）
  - 自由記述（特記事項）

---

## 3. 競合他社調査結果

### 3.1 主要ICTシステムの特徴

#### 3.1.1 CoDMON（コドモン）
- **市場シェア**: 業界No.1、年間3,000施設以上が導入
- **生活記録**: 個別園児ごとに時系列で記録
- **午睡チェック**: 5分ごとのチェックに対応、センサー連携あり
- **記録項目**: 食事、体温、午睡、排泄を自動的に連絡帳に転記
- **料金**: 月額5,500円（税込）

#### 3.1.2 Lookme（ルクミー）
- **導入実績**: 全国15,000施設以上
- **午睡チェック**: ボタン式センサーで体動検知、記録アプリで自動記録
- **データ連携**: 午睡チェックと体温計アプリが連携
- **料金**: 月額5,500円（税込）

#### 3.1.3 ぴよログ（育児記録アプリ）
- **対象**: 家庭向け（保育園への応用可能）
- **記録項目**: 母乳、ミルク、離乳食、おやつ、うんち、おしっこ、睡眠、体温
- **操作性**: 片手で簡単操作、タイマー機能
- **データ共有**: パートナーとリアルタイム共有

### 3.2 業界標準のUI/UXパターン

#### 3.2.1 記録方式
- **個別園児単位**: 1人の園児に対して時系列で記録を追加していく方式
- **タイムライン表示**: 記録した項目を時刻順に並べて表示
- **ワンタップ記録**: スタンプやボタンで素早く記録完了

#### 3.2.2 記録画面の構成
1. **園児選択画面**: クラスから園児を選択
2. **記録タイプ選択**: ミルク、午睡、排泄、体温などから選択
3. **詳細入力画面**: 時刻、量、状態などを入力
4. **確認・保存**: 入力内容を確認して保存

---

## 4. 新仕様の全体設計

### 4.1 基本方針

#### 4.1.1 個別園児記録方式
- **旧仕様**: 複数園児を一度に選択して一括登録
- **新仕様**: 1人の園児を選択して、その園児の記録を時系列で追加

#### 4.1.2 記録カテゴリ
生活記録を以下の6つのカテゴリに分類：
1. **ミルク記録**（0～1歳児）
2. **離乳食・おやつ・昼食記録**（1歳児以上）
3. **午睡記録**（全年齢、午睡チェック含む）
4. **排泄記録**（全年齢、おしっこ・うんち）
5. **体温記録**（全年齢）
6. **機嫌・様子記録**（全年齢）

#### 4.1.3 年齢別記録項目マトリクス

| 記録カテゴリ | 0歳児 | 1歳児 | 2歳児以上 |
|------------|------|------|----------|
| ミルク | ◎ (mL) | ○ (mL) | - |
| 離乳食 | - | ◎ (5段階) | - |
| おやつ・昼食 | - | ○ (5段階) | ◎ (5段階) |
| 午睡 | ◎ (5分間隔チェック) | ◎ (10分間隔チェック) | ○ (15分間隔チェック) |
| 排泄 | ◎ (詳細) | ◎ (詳細) | ○ (簡易) |
| 体温 | ◎ | ◎ | ○ |
| 機嫌・様子 | ◎ | ◎ | ○ |

### 4.2 記録フロー

```
【ステップ1】園児選択
  ↓
【ステップ2】日付選択（デフォルト: 今日）
  ↓
【ステップ3】記録カテゴリ選択
  - ミルク
  - 離乳食・食事
  - 午睡
  - 排泄
  - 体温
  - 機嫌・様子
  ↓
【ステップ4】詳細入力
  - 時刻（デフォルト: 現在時刻）
  - カテゴリ別の詳細項目
  ↓
【ステップ5】確認・保存
  ↓
【ステップ6】タイムライン表示
  - 保存した記録が時系列で表示される
  - 続けて記録を追加可能
```

---

## 5. 機能要件詳細

### 5.1 ミルク記録

#### 5.1.1 入力項目
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 時刻 | ○ | HH:mm | 現在時刻 | - |
| ミルク量 | ○ | 数値（mL） | - | 0～500mL、10mL単位で入力 |
| メモ | - | テキスト | - | 最大500文字 |

#### 5.1.2 入力UI
- **時刻入力**: タイムピッカー + クイック選択ボタン（「今」「5分前」「10分前」）
- **ミルク量入力**: 数値キーパッド + よく使う量のクイック選択ボタン（80mL、100mL、120mL、150mL、200mL）
- **保存ボタン**: 「記録を保存」

#### 5.1.3 バリデーション
- ミルク量: 0mLより大きく、500mL以下
- 時刻: 未来の時刻は入力不可
- 同じ園児の同じ時刻に重複記録がある場合は警告表示

### 5.2 離乳食・おやつ・昼食記録

#### 5.2.1 入力項目
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 時刻 | ○ | HH:mm | 現在時刻 | - |
| 食事種別 | ○ | 選択 | - | 「午前おやつ」「昼食」「午後おやつ」「離乳食」 |
| 摂取量 | ○ | 選択 | - | 「完食」「ほぼ完食」「半分」「少量」「食べず」 |
| メモ | - | テキスト | - | 最大500文字 |

#### 5.2.2 入力UI
- **食事種別**: 大きなボタン4つ（午前おやつ、昼食、午後おやつ、離乳食）
- **摂取量**: 大きなボタン5つ（完食、ほぼ完食、半分、少量、食べず）
- **色分け**:
  - 完食: 緑
  - ほぼ完食: 黄緑
  - 半分: 黄色
  - 少量: オレンジ
  - 食べず: 赤

### 5.3 午睡記録

#### 5.3.1 午睡時間記録
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 開始時刻 | ○ | HH:mm | - | - |
| 終了時刻 | - | HH:mm | - | 起床時に記録 |
| メモ | - | テキスト | - | 最大500文字 |

#### 5.3.2 午睡チェック記録
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 午睡記録ID | ○ | 外部キー | - | 紐づく午睡時間記録 |
| チェック時刻 | ○ | HH:mm | 現在時刻 | - |
| 呼吸確認 | ○ | 選択 | - | 「正常」「異常」 |
| 頭の向き | ○ | 選択 | - | 「左」「右」「仰向け」 |
| 体温チェック | ○ | 選択 | - | 「正常」「やや温かい」「冷たい」 |
| 顔色 | ○ | 選択 | - | 「正常」「蒼白」「紫色」 |
| 体勢 | ○ | 選択 | - | 「仰向け」「横向き」「うつ伏せ」 |
| 記録者 | ○ | スタッフID | ログインユーザー | - |

#### 5.3.3 午睡チェックUI
- **チェック間隔タイマー**: 年齢に応じて5分/10分/15分のタイマー表示
- **クイック記録**: 全項目が「正常」の場合、「正常記録」ボタン1タップで記録完了
- **異常時アラート**: 「呼吸異常」「うつ伏せ」選択時は赤色の警告表示
- **チェック履歴**: 当日の午睡チェック履歴を時系列表示

### 5.4 排泄記録

#### 5.4.1 入力項目
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 時刻 | ○ | HH:mm | 現在時刻 | - |
| おしっこ有無 | - | チェックボックス | - | おしっこがあった場合チェック |
| おしっこ量 | - | 選択 | - | 「少量」「普通」「多量」 |
| うんち有無 | - | チェックボックス | - | うんちがあった場合チェック |
| うんち量 | - | 選択 | - | 「少量」「普通」「多量」 |
| うんちの種類 | - | 選択 | - | 「正常」「軟便」「下痢」「硬い」「血便」 |
| メモ | - | テキスト | - | 最大500文字 |

#### 5.4.2 入力UI
- **おむつ交換タイプ選択**:
  - 「おしっこのみ」ボタン
  - 「うんちのみ」ボタン
  - 「おしっこ + うんち」ボタン
- **選択に応じた項目表示**: ボタン選択後、該当項目のみ表示
- **色分け**:
  - おしっこ: 水色系
  - うんち: 茶色系
  - 血便選択時: 赤色の警告表示

#### 5.4.3 バリデーション
- おしっこ有無がチェックされている場合、おしっこ量は必須
- うんち有無がチェックされている場合、うんち量とうんちの種類は必須
- おしっこ・うんち両方がチェックされていない場合はエラー

### 5.5 体温記録

#### 5.5.1 入力項目
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 時刻 | ○ | HH:mm | 現在時刻 | - |
| 体温 | ○ | 数値（℃） | - | 34.0～42.0℃、0.1℃単位 |
| 測定箇所 | - | 選択 | 「脇下」 | 「脇下」「耳」「額」 |
| メモ | - | テキスト | - | 最大500文字 |

#### 5.5.2 入力UI
- **体温入力**: 数値キーパッド（小数点対応）
- **体温範囲による色分け**:
  - 37.5℃未満: 緑（正常）
  - 37.5～38.0℃: 黄色（微熱）
  - 38.0℃以上: 赤（発熱）

### 5.6 機嫌・様子記録

#### 5.6.1 入力項目
| 項目 | 必須 | 形式 | デフォルト値 | 備考 |
|------|-----|------|------------|------|
| 記録日 | ○ | YYYY-MM-DD | 今日 | - |
| 時刻 | ○ | HH:mm | 現在時刻 | - |
| 機嫌 | ○ | 選択 | - | 「良い」「普通」「不機嫌」「泣いている」 |
| 様子・特記事項 | ○ | テキスト | - | 最大1000文字 |

---

## 6. データモデル

### 6.1 テーブル設計方針
- **旧仕様**: `InfantRecords`テーブル1つで全記録を管理（複雑なカラム構造）
- **新仕様**: 記録カテゴリごとに専用テーブルを作成（正規化）

### 6.2 テーブル構成

実際のデータベーステーブル定義は `docs/infant/infant-records-create-tables.sql` を参照してください。

#### 6.2.1 新規テーブル

**InfantMilks（ミルク記録）**
```sql
CREATE TABLE [dbo].[InfantMilks] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [MilkTime] TIME NOT NULL,
    [AmountMl] INT NOT NULL,
    [Notes] NVARCHAR(500),
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantMilks] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [MilkTime])
);
```

**InfantSleepChecks（午睡チェック）**
```sql
CREATE TABLE [dbo].[InfantSleepChecks] (
    [Id] INT IDENTITY(1,1) NOT NULL,
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [SleepSequence] INT NOT NULL,
    [CheckTime] TIME NOT NULL,
    [BreathingStatus] NVARCHAR(20) NOT NULL,  -- Normal:正常/Abnormal:異常
    [HeadDirection] NVARCHAR(20) NOT NULL,    -- Left:左/Right:右/FaceUp:仰向け
    [BodyTemperature] NVARCHAR(20) NOT NULL,  -- Normal:正常/SlightlyWarm:やや温かい/Cold:冷たい
    [FaceColor] NVARCHAR(20) NOT NULL,        -- Normal:正常/Pale:蒼白/Purple:紫色
    [BodyPosition] NVARCHAR(20) NOT NULL,     -- OnBack:仰向け/OnSide:横向き/FaceDown:うつ伏せ
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantSleepChecks] PRIMARY KEY ([Id])
);
```

#### 6.2.2 既存テーブル修正

**InfantMeals（食事記録）** - MealTime, Notes カラム追加
```sql
CREATE TABLE [dbo].[InfantMeals] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [MealTime] TIME DEFAULT '12:00:00' NOT NULL,
    [MealType] NVARCHAR(20) NOT NULL,  -- MorningSnack:午前おやつ/Lunch:昼食/AfternoonSnack:午後おやつ/BabyFood:離乳食
    [OverallAmount] NVARCHAR(20),      -- All:完食/Most:ほぼ完食/Half:半分/Little:少量/None:食べず
    [Notes] NVARCHAR(500),
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantMeals] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [MealTime])
);
```

**InfantSleeps（午睡記録）** - 修正不要
```sql
CREATE TABLE [dbo].[InfantSleeps] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [SleepSequence] INT DEFAULT 1 NOT NULL,
    [StartTime] DATETIME2 NOT NULL,
    [EndTime] DATETIME2,
    [DurationMinutes] INT,
    [SleepQuality] NVARCHAR(20),
    [Notes] NVARCHAR(500),
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantSleeps] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [SleepSequence])
);
```

**InfantToileting（排泄記録）** - HasUrine, HasStool, BowelAmount カラム追加
```sql
CREATE TABLE [dbo].[InfantToileting] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [ToiletingTime] DATETIME2 NOT NULL,
    [HasUrine] BIT DEFAULT 0 NOT NULL,
    [UrineAmount] NVARCHAR(20),      -- Little:少量/Normal:普通/Lot:多量
    [HasStool] BIT DEFAULT 0 NOT NULL,
    [BowelAmount] NVARCHAR(20),      -- Little:少量/Normal:普通/Lot:多量
    [BowelCondition] NVARCHAR(20),   -- Normal:正常/Soft:軟便/Diarrhea:下痢/Hard:硬い/Bloody:血便
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantToileting] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [ToiletingTime])
);
```

**InfantTemperatures（体温記録）** - MeasurementLocation, Notes カラム追加
```sql
CREATE TABLE [dbo].[InfantTemperatures] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [MeasurementType] NVARCHAR(20) NOT NULL,  -- Morning:朝/Afternoon:午後
    [MeasuredAt] DATETIME2 NOT NULL,
    [Temperature] DECIMAL(3, 1) NOT NULL,
    [MeasurementLocation] NVARCHAR(20) DEFAULT N'Armpit' NOT NULL,  -- Armpit:脇下/Ear:耳/Forehead:額
    [Notes] NVARCHAR(500),
    [IsAbnormal] BIT DEFAULT 0 NOT NULL,
    [CreatedByType] NVARCHAR(20) DEFAULT 'Staff' NOT NULL,  -- Parent:保護者入力/Staff:スタッフ入力
    [IsDraft] BIT DEFAULT 0 NOT NULL,
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantTemperatures] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [MeasurementType])
);
```

**InfantMoods（機嫌記録）** - RecordTime カラム追加
```sql
CREATE TABLE [dbo].[InfantMoods] (
    [NurseryId] INT NOT NULL,
    [ChildId] INT NOT NULL,
    [RecordDate] DATE NOT NULL,
    [RecordTime] TIME NOT NULL,
    [MoodState] NVARCHAR(20) NOT NULL,  -- Good:良い/Normal:普通/Bad:不機嫌/Crying:泣いている
    [Notes] NVARCHAR(500),
    [CreatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [CreatedBy] INT NOT NULL,
    [UpdatedAt] DATETIME2 DEFAULT [dbo].[GetJstDateTime]() NOT NULL,
    [UpdatedBy] INT NOT NULL,
    CONSTRAINT [PK_InfantMoods] PRIMARY KEY ([NurseryId], [ChildId], [RecordDate], [RecordTime])
);
```

#### テーブル設計のポイント

- **複合主キー**: InfantSleepChecks 以外はすべて複合主キーを使用
- **1日複数回記録**: 時刻カラム（TIME型）を主キーに含めることで、同日複数回の記録に対応
- **JST対応**: DEFAULT値に `[dbo].[GetJstDateTime]()` 関数を使用
- **外部キー制約なし**: プロジェクトのポリシーに従い、アプリケーション層で整合性を保証

---

## 7. UI/UX設計

### 7.1 画面遷移フロー

```
【メイン画面】
├─ クラス選択
│  └─ 園児一覧表示
│     └─ 園児選択
│        ├─ 【園児詳細画面】（タイムライン表示）
│        │  ├─ 今日の記録一覧（時系列）
│        │  ├─ 「記録を追加」ボタン
│        │  │  └─ 【記録タイプ選択画面】
│        │  │     ├─ ミルク記録 → 【ミルク記録入力画面】
│        │  │     ├─ 食事記録 → 【食事記録入力画面】
│        │  │     ├─ 午睡記録 → 【午睡記録入力画面】
│        │  │     ├─ 排泄記録 → 【排泄記録入力画面】
│        │  │     ├─ 体温記録 → 【体温記録入力画面】
│        │  │     └─ 機嫌・様子記録 → 【機嫌記録入力画面】
│        │  └─ 各記録の編集・削除
│        └─ 日付変更ボタン（過去の記録閲覧）
```

### 7.2 主要画面のワイヤーフレーム

#### 7.2.1 園児詳細画面（タイムライン）

```
┌────────────────────────────────────────┐
│ < 戻る    田中 太郎 (0歳児)    2026/01/17 │
├────────────────────────────────────────┤
│ [+ 記録を追加]                          │
├────────────────────────────────────────┤
│ ◉ 13:45 ミルク                         │
│   量: 150mL                            │
│   記録者: 山田先生                      │
│   [編集] [削除]                         │
├────────────────────────────────────────┤
│ 😴 13:00 午睡開始                      │
│   チェック回数: 9回                     │
│   記録者: 山田先生                      │
│   [チェック履歴] [終了記録] [削除]       │
├────────────────────────────────────────┤
│ 🍽️ 11:45 離乳食                       │
│   種別: 昼食                           │
│   摂取量: ほぼ完食                      │
│   記録者: 佐藤先生                      │
│   [編集] [削除]                         │
├────────────────────────────────────────┤
│ 🚽 10:30 おむつ交換                    │
│   おしっこ: 普通                        │
│   うんち: 少量（正常）                  │
│   記録者: 田中先生                      │
│   [編集] [削除]                         │
└────────────────────────────────────────┘
```

#### 7.2.2 記録タイプ選択画面

```
┌────────────────────────────────────────┐
│ < 戻る    記録を追加    田中 太郎       │
├────────────────────────────────────────┤
│                                        │
│  ┌──────────┐  ┌──────────┐          │
│  │ 🍼 ミルク │  │ 🍽️ 食事  │          │
│  └──────────┘  └──────────┘          │
│                                        │
│  ┌──────────┐  ┌──────────┐          │
│  │ 😴 午睡   │  │ 🚽 排泄  │          │
│  └──────────┘  └──────────┘          │
│                                        │
│  ┌──────────┐  ┌──────────┐          │
│  │ 🌡️ 体温   │  │ 😊 機嫌  │          │
│  └──────────┘  └──────────┘          │
│                                        │
└────────────────────────────────────────┘
```

#### 7.2.3 ミルク記録入力画面

```
┌────────────────────────────────────────┐
│ < 戻る    ミルク記録    田中 太郎       │
├────────────────────────────────────────┤
│ 時刻                                   │
│ ┌──────────────┐                      │
│ │ 13:45        │  [今] [5分前] [10分前] │
│ └──────────────┘                      │
│                                        │
│ ミルク量（mL）                          │
│ ┌──────────────┐                      │
│ │ 150          │                       │
│ └──────────────┘                      │
│ [80] [100] [120] [150] [200]          │
│                                        │
│ メモ（任意）                            │
│ ┌────────────────────────────────┐    │
│ │                                │    │
│ │                                │    │
│ └────────────────────────────────┘    │
│                                        │
│         [記録を保存]                    │
└────────────────────────────────────────┘
```

#### 7.2.4 午睡チェック記録画面

```
┌────────────────────────────────────────┐
│ < 戻る    午睡チェック    田中 太郎     │
├────────────────────────────────────────┤
│ 午睡開始時刻: 13:00                     │
│ 経過時間: 45分                         │
│ 次回チェック: 5分後                     │
├────────────────────────────────────────┤
│ チェック時刻                            │
│ ┌──────────────┐                      │
│ │ 13:45        │  [今]                 │
│ └──────────────┘                      │
│                                        │
│ [✓ 全項目正常（クイック記録）]          │
│                                        │
│ または個別に記録:                        │
│                                        │
│ 呼吸確認                                │
│ (◉) 正常   ( ) 異常                    │
│                                        │
│ 頭の向き                                │
│ ( ) 左   (◉) 右   ( ) 仰向け           │
│                                        │
│ 体温チェック（触感）                     │
│ (◉) 正常   ( ) やや温かい   ( ) 冷たい  │
│                                        │
│ 顔色                                   │
│ (◉) 正常   ( ) 蒼白   ( ) 紫色         │
│                                        │
│ 体勢                                   │
│ (◉) 仰向け   ( ) 横向き   ( ) うつ伏せ  │
│                                        │
│         [チェックを記録]                 │
└────────────────────────────────────────┘
```

#### 7.2.5 排泄記録入力画面

```
┌────────────────────────────────────────┐
│ < 戻る    排泄記録    田中 太郎         │
├────────────────────────────────────────┤
│ 時刻                                   │
│ ┌──────────────┐                      │
│ │ 10:30        │  [今] [5分前] [10分前] │
│ └──────────────┘                      │
│                                        │
│ 記録タイプ                              │
│ [おしっこのみ] [うんちのみ] [両方]      │
│                                        │
│ ──── おしっこ ────                     │
│ 量                                     │
│ ( ) 少量   (◉) 普通   ( ) 多量         │
│                                        │
│ ──── うんち ────                       │
│ 量                                     │
│ ( ) 少量   (◉) 普通   ( ) 多量         │
│                                        │
│ 種類                                   │
│ (◉) 正常   ( ) 軟便   ( ) 下痢         │
│ ( ) 硬い   ( ) 血便                    │
│                                        │
│ メモ（任意）                            │
│ ┌────────────────────────────────┐    │
│ │                                │    │
│ └────────────────────────────────┘    │
│                                        │
│         [記録を保存]                    │
└────────────────────────────────────────┘
```

### 7.3 UX設計のポイント

#### 7.3.1 操作性
- **片手操作**: タブレットを片手で持ちながら記録できるボタン配置
- **大きなタップ領域**: 誤タップ防止のため、ボタンは最小44×44px
- **クイック入力**: よく使う値はワンタップで入力完了

#### 7.3.2 視認性
- **色分け**: 記録カテゴリごとに色を統一（ミルク: 青、食事: 緑、午睡: 紫、排泄: 茶、体温: 赤、機嫌: 黄）
- **アイコン**: 各記録に絵文字アイコンを使用
- **状態表示**: 正常/異常を色で区別（正常: 緑、注意: 黄、異常: 赤）

#### 7.3.3 エラー防止
- **入力検証**: リアルタイムバリデーション
- **確認ダイアログ**: 削除時は確認モーダル表示
- **自動保存**: 一定時間ごとに下書き保存

---

## 8. 実装優先順位

### 8.1 Phase 1: 基本機能実装（最優先）
**期間**: 2週間
**内容**:
1. データベーススキーマ作成（7テーブル）
2. バックエンドAPI実装
   - ミルク記録CRUD
   - 食事記録CRUD
   - 排泄記録CRUD
   - 体温記録CRUD
3. フロントエンド基本UI
   - 園児選択画面
   - 記録タイプ選択画面
   - ミルク記録入力画面
   - 排泄記録入力画面
4. タイムライン表示機能

### 8.2 Phase 2: 午睡チェック機能（高優先度）
**期間**: 1.5週間
**内容**:
1. 午睡記録テーブル・API実装
2. 午睡チェックテーブル・API実装
3. 午睡記録入力画面
4. 午睡チェック記録画面
5. チェック間隔タイマー機能
6. クイック記録機能

### 8.3 Phase 3: その他記録機能（中優先度）
**期間**: 1週間
**内容**:
1. 食事記録入力画面
2. 体温記録入力画面
3. 機嫌・様子記録入力画面

### 8.4 Phase 4: 拡張機能（低優先度）
**期間**: 1週間
**内容**:
1. 記録の編集・削除機能
2. 過去日付の記録閲覧
3. 記録の検索・フィルタリング
4. 記録の統計表示（週次、月次）
5. CSVエクスポート機能

### 8.5 Phase 5: 最適化・改善（継続的）
**内容**:
1. パフォーマンス最適化
2. UI/UXの改善
3. バリデーションの強化
4. エラーハンドリングの改善
5. アクセシビリティ対応

---

## 9. 非機能要件

### 9.1 パフォーマンス
- **記録保存**: 1秒以内
- **タイムライン表示**: 2秒以内（100件まで）
- **午睡チェック記録**: 0.5秒以内（緊急性が高いため）

### 9.2 セキュリティ
- **権限チェック**: スタッフは担当クラスの園児のみ記録可能
- **データ保護**: 記録の編集・削除は記録者本人のみ可能
- **監査ログ**: 全ての記録操作をログに記録

### 9.3 可用性
- **稼働時間**: 99.9%以上（保育時間中）
- **バックアップ**: 1日1回、自動バックアップ
- **データ保持**: 卒園後3年間保持

### 9.4 拡張性
- **将来対応**: センサー連携（午睡センサー、体温計）
- **API拡張**: 保護者アプリへの記録共有
- **多言語対応**: 日本語、英語、中国語、韓国語

---

## 10. まとめ

### 10.1 旧仕様との主な違い

| 項目 | 旧仕様 | 新仕様 |
|------|--------|--------|
| 記録方式 | 複数園児一括登録 | 個別園児の時系列記録 |
| ミルク記録 | あいまいな「量」 | mL単位で詳細記録 |
| 午睡チェック | 簡易的な記録 | SIDS対策準拠の詳細チェック |
| 排泄記録 | おしっこ・うんち別々 | 同時記録可能 |
| データ構造 | 1テーブルで全管理 | カテゴリ別に7テーブル |
| UI | 一括入力フォーム | カテゴリ別の専用画面 |

### 10.2 期待される効果

1. **記録精度の向上**: mL単位、詳細なチェック項目により正確な記録が可能
2. **SIDS対策強化**: 5分間隔の午睡チェックが確実に実施できる
3. **保育士の負担軽減**: クイック入力機能で記録時間を短縮
4. **保護者への情報提供**: 詳細な記録を保護者と共有可能
5. **業務効率化**: 記録のデジタル化により、手書き台帳が不要に

### 10.3 次のアクション

1. ✅ 保育士へのヒアリング実施
2. ✅ 競合他社調査完了
3. ✅ 新仕様書作成完了
4. ⏳ **次**: データベーススキーマのレビューと承認
5. ⏳ **次**: Phase 1の実装開始

---

**END OF DOCUMENT**
