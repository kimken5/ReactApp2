# ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å•é¡Œä¿®æ­£ã‚µãƒãƒªãƒ¼

## å•é¡Œã®æ¦‚è¦

`toISOString().split('T')[0]`ã‚’ä½¿ç”¨ã—ãŸæ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã‚ˆã‚Šã€JSTã®æ—¥ä»˜ãŒUTCã«å¤‰æ›ã•ã‚Œã€9æ™‚é–“ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ãšã‚ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã—ãŸã€‚

### å…·ä½“ä¾‹
```typescript
// å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰
const date = new Date(2026, 1, 7, 0, 0, 0); // 2026-02-07 00:00:00 JST
const dateStr = date.toISOString().split('T')[0]; // "2026-02-06" â† 1æ—¥å‰ã«ãšã‚Œã‚‹
```

### å½±éŸ¿
- ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã®æ—¥ä»˜ç¯„å›²ã‚¯ã‚¨ãƒªã§é€±æœ«ã®åœŸæ›œæ—¥ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããªã„
- çŒ®ç«‹ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§æœˆæœ«ãƒ‡ãƒ¼ã‚¿ãŒæ¬ è½ã™ã‚‹
- ä¼‘åœ’æ—¥ãƒ»ä¼‘æ—¥ä¿è‚²è¨­å®šã§1å¹´å¾Œã®ãƒ‡ãƒ¼ã‚¿ç¯„å›²ãŒãšã‚Œã‚‹

---

## è§£æ±ºç­–

### å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `reactapp.client/src/utils/dateUtils.ts`

```typescript
// ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³(JST)ã§æ—¥ä»˜ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
export function formatLocalDate(date: Date): string {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

// ä»Šæ—¥ã®æ—¥ä»˜ã‚’å–å¾—
export function getTodayLocal(): string {
  return formatLocalDate(new Date());
}

// æ—¥æ•°ã‚’åŠ æ¸›ç®—
export function addDays(date: Date | string, days: number): string {
  const d = typeof date === 'string' ? new Date(date) : new Date(date);
  d.setDate(d.getDate() + days);
  return formatLocalDate(d);
}

// å¹´æ•°ã‚’åŠ æ¸›ç®—
export function addYears(date: Date | string, years: number): string {
  const d = typeof date === 'string' ? new Date(date) : new Date(date);
  d.setFullYear(d.getFullYear() + years);
  return formatLocalDate(d);
}
```

---

## ä¿®æ­£æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### ğŸ”´ é«˜å„ªå…ˆåº¦: æ—¥ä»˜ç¯„å›²ã‚¯ã‚¨ãƒªç³»(ãƒ‡ãƒ¼ã‚¿æ¬ è½ãƒªã‚¹ã‚¯)

| ãƒ•ã‚¡ã‚¤ãƒ« | ä¿®æ­£ç®‡æ‰€ | å½±éŸ¿ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|---------|---------|------|----------|
| **CalendarPage.tsx** (ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—) | Line 126-127, 177-178 | ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ä¼‘åœ’æ—¥å–å¾—ã®æ—¥ä»˜ç¯„å›² | âœ… å®Œäº† |
| **Calendar.tsx** (è¦ªã‚¢ãƒ—ãƒª) | Line 162-163 | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆå–å¾— | âœ… å®Œäº† |
| **DailyMenusPage.tsx** | Line 38-39, 259 | çŒ®ç«‹ãƒ‡ãƒ¼ã‚¿å–å¾—ã€ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º | âœ… å®Œäº† |
| **NurseryDayTypeDialog.tsx** | Line 54-55, 79 | 1å¹´å‰ã€œ1å¹´å¾Œã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã€åˆæœŸæ—¥ä»˜ | âœ… å®Œäº† |
| **AttendanceReportPage.tsx** | Line 46-47 | 30æ—¥é–“ã®å‡ºæ¬ çµ±è¨ˆåˆæœŸæ—¥ä»˜ç¯„å›² | âœ… å®Œäº† |

### ğŸŸ¡ ä¸­å„ªå…ˆåº¦: æ—¥ä»˜é¸æŠãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç³»

| ãƒ•ã‚¡ã‚¤ãƒ« | ä¿®æ­£ç®‡æ‰€ | å½±éŸ¿ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|---------|---------|------|----------|
| **AttendancePage.tsx** | Line 26, 59, 168, 175 | åˆæœŸæ—¥ä»˜ã€5æ—¥é–“ç¯„å›²è¨ˆç®—ã€æ—¥ä»˜ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | â³ ä¿ç•™ |
| **InfantRecordsPage.tsx** | Line 79, 228, 234 | åˆæœŸæ—¥ä»˜ã€æ—¥ä»˜ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | â³ ä¿ç•™ |
| **ClassTemperatureBulkPage.tsx** | Line 29, 183, 190 | åˆæœŸæ—¥ä»˜ã€æ—¥ä»˜ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ | â³ ä¿ç•™ |
| **DailyMenuFormPage.tsx** | Line 21, 401, 421 | åˆæœŸæ—¥ä»˜ã€æ—¥ä»˜ãƒ”ãƒƒã‚«ãƒ¼ | â³ ä¿ç•™ |

### ğŸŸ¢ ä½å„ªå…ˆåº¦: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒ»åˆ¶ç´„ç³»

| ãƒ•ã‚¡ã‚¤ãƒ« | ä¿®æ­£ç®‡æ‰€ | å½±éŸ¿ | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|---------|---------|------|----------|
| **EventFormModal.tsx** | Line 81 | ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ—¥ä»˜ | â³ ä¿ç•™ |
| **DashboardPage.tsx** | Line 52, 58 | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ä»Šæ—¥ã®æ—¥ä»˜è¡¨ç¤º | â³ ä¿ç•™ |
| **DailyReportFormPage.tsx** | Line 51, 61, 449, 518, 736 | æ—¥å ±ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ—¥ä»˜ã€maxå±æ€§ | â³ ä¿ç•™ |
| **AnnouncementFormPage.tsx** | Line 129 | ãŠçŸ¥ã‚‰ã›ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ—¥ä»˜ | â³ ä¿ç•™ |
| **ParentFormPage.tsx** | Line 107 | ä¿è­·è€…ã®ç”Ÿå¹´æœˆæ—¥ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | â³ ä¿ç•™ |
| **StaffFormPage.tsx** | Line 86 | è·å“¡ã®ç”Ÿå¹´æœˆæ—¥ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ | â³ ä¿ç•™ |
| **EntryExitLogsPage.tsx** | Line 164 | CSVãƒ•ã‚¡ã‚¤ãƒ«åã®æ—¥ä»˜ | â³ ä¿ç•™ |
| **AcademicYearCreate.tsx** | Line 74 | å­¦å¹´åº¦ã®é–‹å§‹æ—¥ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | â³ ä¿ç•™ |

### âšª å½±éŸ¿ãªã—: ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿(CalendarPage.tsx Line 53-63)

ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰å°‚ç”¨ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆãªã®ã§ã€å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ã«ã¯å½±éŸ¿ãªã—ã€‚

---

## ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³

### Before (å•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰)
```typescript
const date = new Date();
const dateStr = date.toISOString().split('T')[0]; // UTCã«å¤‰æ›ã•ã‚Œã¦ã—ã¾ã†
```

### After (ä¿®æ­£å¾Œã®ã‚³ãƒ¼ãƒ‰)
```typescript
import { formatLocalDate, getTodayLocal, addDays, addYears } from '../../utils/dateUtils';

// ãƒ‘ã‚¿ãƒ¼ãƒ³1: å˜ç´”ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
const dateStr = formatLocalDate(new Date());

// ãƒ‘ã‚¿ãƒ¼ãƒ³2: ä»Šæ—¥ã®æ—¥ä»˜
const today = getTodayLocal();

// ãƒ‘ã‚¿ãƒ¼ãƒ³3: æ—¥æ•°è¨ˆç®—
const thirtyDaysAgo = addDays(new Date(), -30);

// ãƒ‘ã‚¿ãƒ¼ãƒ³4: å¹´æ•°è¨ˆç®—
const oneYearLater = addYears(new Date(), 1);
```

---

## æ¤œè¨¼æ–¹æ³•

### ä¿®æ­£å‰
```
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°:
[NurseryDayType] Loading data: { startDate: "2026-01-31", endDate: "2026-02-06", viewMode: "week" }
[NurseryDayType] Data loaded: { count: 2, dates: ['2026-01-31', '2026-02-01'] }
```
â†’ 2026-02-07ã®åœŸæ›œæ—¥ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã•ã‚Œã¦ã„ãªã„

### ä¿®æ­£å¾Œ
```
ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°:
[NurseryDayType] Loading data: { startDate: "2026-01-31", endDate: "2026-02-07", viewMode: "week" }
[NurseryDayType] Data loaded: { count: 3, dates: ['2026-01-31', '2026-02-01', '2026-02-07'] }
```
â†’ åœŸæ›œæ—¥ã®ãƒ‡ãƒ¼ã‚¿ã‚‚æ­£ã—ãå–å¾—ã•ã‚Œã‚‹

---

## ä»Šå¾Œã®å¯¾å¿œ

### ä¸­å„ªå…ˆåº¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

æ®‹ã‚Šã®æ—¥ä»˜é¸æŠãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç³»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ(AttendancePage, InfantRecordsPage, ClassTemperatureBulkPage, DailyMenuFormPage)ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ä½å„ªå…ˆåº¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„maxå±æ€§ãªã©ã€ãƒ‡ãƒ¼ã‚¿æ¬ è½ã®ç›´æ¥çš„ãªåŸå› ã«ã¯ãªã‚‰ãªã„ãŒã€ä¸€è²«æ€§ã®ãŸã‚ã«ä¿®æ­£ãŒæœ›ã¾ã—ã„ç®‡æ‰€ã€‚

### æ–°è¦ã‚³ãƒ¼ãƒ‰ä½œæˆæ™‚ã®æ³¨æ„

- **ç¦æ­¢ãƒ‘ã‚¿ãƒ¼ãƒ³**: `date.toISOString().split('T')[0]`
- **æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³**: `formatLocalDate(date)` ã¾ãŸã¯ `getTodayLocal()`
- **ç†ç”±**: UTCã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›ã«ã‚ˆã‚‹æ—¥ä»˜ãšã‚Œã‚’é˜²ã

---

## å‚è€ƒæƒ…å ±

### ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®ä»•çµ„ã¿

- **JST (Japan Standard Time)**: UTC+9
- **å•é¡Œ**: `toISOString()`ã¯UTCã«å¤‰æ›ã™ã‚‹ãŸã‚ã€JST 00:00:00ãŒUTC 15:00:00(å‰æ—¥)ã«ãªã‚‹
- **è§£æ±º**: `getFullYear()`, `getMonth()`, `getDate()`ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®å€¤ã‚’ç›´æ¥å–å¾—

### é–¢é€£Issue

- åˆå›å ±å‘Š: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ç”»é¢ã«ä¼‘æ—¥ä¿è‚²æ—¥ãŒè¡¨ç¤ºã•ã‚Œãªã„(2026-02-07)
- æ ¹æœ¬åŸå› : `toISOString()`ã«ã‚ˆã‚‹ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å¤‰æ›
- ä¿®æ­£æ—¥: 2026-02-07

---

## ã¾ã¨ã‚

âœ… **é«˜å„ªå…ˆåº¦ã®ä¿®æ­£å®Œäº†**: ãƒ‡ãƒ¼ã‚¿æ¬ è½ãƒªã‚¹ã‚¯ã®ã‚ã‚‹æ—¥ä»˜ç¯„å›²ã‚¯ã‚¨ãƒªç³»ã¯å…¨ã¦ä¿®æ­£æ¸ˆã¿  
â³ **ä¸­å„ªå…ˆåº¦ã¯ä¿ç•™**: æ—¥ä»˜é¸æŠãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç³»ã¯æ©Ÿèƒ½ã«å½±éŸ¿ã™ã‚‹ãŸã‚ã€ä»Šå¾Œä¿®æ­£äºˆå®š  
ğŸŸ¢ **ä½å„ªå…ˆåº¦ã¯å¾Œå›ã—**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚„è¡¨ç¤ºç³»ã¯ä¸€è²«æ€§ã®ãŸã‚å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£  

**æœ€é‡è¦**: æ–°è¦ã‚³ãƒ¼ãƒ‰ä½œæˆæ™‚ã¯å¿…ãš`dateUtils.ts`ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã€‚
